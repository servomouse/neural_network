#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include "neuron.h"
#include "micronet.h"
#include "utils.h"

#define sizeof_arr(_x) sizeof(_x)/sizeof(_x[0])

// Neuron types:
// 0 - linear
// 1 - polynomial

uint32_t poly_neurons[] = {
    // idx  num_inputs  type indices
       8,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
       9,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      10,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      11,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      12,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      13,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      14,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      15,   8,          1,   0, 1, 2, 3, 4, 5, 6, 7,
      16,   8,          1,   8, 9, 10, 11, 12, 13, 14, 15
};

micronet_map_t poly_micronet_map = {
    .num_inputs = 8,
    .num_neurons = 9,
    .net_size = 17,
    .neurons = poly_neurons,
    .num_outputs = 1,
    .output_indices = {16},
};

double poly_coeffs[9][256] = {  // Plus offset
    {0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768},
    {-0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576},
    {-0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384},
    {-0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192},
    {-0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768},
    {0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576},
    {0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384},
    {0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768,
     0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192},
    {0.006, 0.012, 0.018, 0.024, 0.030, 0.036, 0.042, 0.048, 0.054, 0.060, 0.066, 0.072, 0.078, 0.084, 0.090, 0.096,
     0.102, 0.108, 0.114, 0.120, 0.126, 0.132, 0.138, 0.144, 0.150, 0.156, 0.162, 0.168, 0.174, 0.180, 0.186, 0.192,
     0.198, 0.204, 0.210, 0.216, 0.222, 0.228, 0.234, 0.240, 0.246, 0.252, 0.258, 0.264, 0.270, 0.276, 0.282, 0.288,
     0.294, 0.300, 0.306, 0.312, 0.318, 0.324, 0.330, 0.336, 0.342, 0.348, 0.354, 0.360, 0.366, 0.372, 0.378, 0.384,
     0.390, 0.396, 0.402, 0.408, 0.414, 0.420, 0.426, 0.432, 0.438, 0.444, 0.450, 0.456, 0.462, 0.468, 0.474, 0.480,
     0.486, 0.492, 0.498, 0.504, 0.510, 0.516, 0.522, 0.528, 0.534, 0.540, 0.546, 0.552, 0.558, 0.564, 0.570, 0.576,
     0.582, 0.588, 0.594, 0.600, 0.606, 0.612, 0.618, 0.624, 0.630, 0.636, 0.642, 0.648, 0.654, 0.660, 0.666, 0.672,
     0.678, 0.684, 0.690, 0.696, 0.702, 0.708, 0.714, 0.720, 0.726, 0.732, 0.738, 0.744, 0.750, 0.756, 0.762, 0.768,
     -0.006, -0.012, -0.018, -0.024, -0.030, -0.036, -0.042, -0.048, -0.054, -0.060, -0.066, -0.072, -0.078, -0.084, -0.090, -0.096,
     -0.102, -0.108, -0.114, -0.120, -0.126, -0.132, -0.138, -0.144, -0.150, -0.156, -0.162, -0.168, -0.174, -0.180, -0.186, -0.192,
     -0.198, -0.204, -0.210, -0.216, -0.222, -0.228, -0.234, -0.240, -0.246, -0.252, -0.258, -0.264, -0.270, -0.276, -0.282, -0.288,
     -0.294, -0.300, -0.306, -0.312, -0.318, -0.324, -0.330, -0.336, -0.342, -0.348, -0.354, -0.360, -0.366, -0.372, -0.378, -0.384,
     -0.390, -0.396, -0.402, -0.408, -0.414, -0.420, -0.426, -0.432, -0.438, -0.444, -0.450, -0.456, -0.462, -0.468, -0.474, -0.480,
     -0.486, -0.492, -0.498, -0.504, -0.510, -0.516, -0.522, -0.528, -0.534, -0.540, -0.546, -0.552, -0.558, -0.564, -0.570, -0.576,
     -0.582, -0.588, -0.594, -0.600, -0.606, -0.612, -0.618, -0.624, -0.630, -0.636, -0.642, -0.648, -0.654, -0.660, -0.666, -0.672,
     -0.678, -0.684, -0.690, -0.696, -0.702, -0.708, -0.714, -0.720, -0.726, -0.732, -0.738, -0.744, -0.750, -0.756, -0.762, -0.768},
};

typedef struct {
    double inputs[8];
    double outputs[1];
} dataset_entry_t;

dataset_entry_t poly_dataset[] = {
    {.inputs = {0.529770, 0.513530, -0.816710, 0.782040, -0.253210, 0.815240, 0.986080, -0.448590},     .outputs = {-0.002814}},
    {.inputs = {0.162020, 0.275190, -0.110570, 0.790030, -0.955080, -0.149450, 0.400800, -0.187050},    .outputs = {-0.043915}},
    {.inputs = {0.395550, -0.124000, 0.152010, 0.901060, -0.265300, -0.443340, -0.574880, -0.094390},   .outputs = {-0.057001}},
    {.inputs = {0.088470, 0.323890, -0.395860, -0.970270, 0.276890, 0.994020, -0.623890, -0.098360},    .outputs = {-0.062746}},
    {.inputs = {0.385110, -0.733820, 0.835140, 0.498580, 0.377300, -0.804740, -0.805480, -0.609420},    .outputs = {-0.074575}},
    {.inputs = {0.067480, 0.585740, 0.661790, -0.991090, 0.837890, -0.050140, 0.187780, -0.357770},     .outputs = {-0.188901}},
    {.inputs = {-0.247110, 0.635490, 0.105380, 0.166300, -0.898310, 0.349960, -0.785940, -0.522200},    .outputs = {-0.235908}},
    {.inputs = {0.150490, 0.703360, 0.302160, 0.826410, -0.986630, -0.991700, 0.850890, 0.355940},      .outputs = {-0.296192}},

    {.inputs = {0.448100, 0.749080, 0.715200, -0.158730, -0.506030, 0.129670, 0.381570, -0.672230},     .outputs = {0.000000}},
    {.inputs = {0.818840, -0.917290, 0.409590, -0.427720, -0.842590, 0.673270, -0.161530, 0.626090},    .outputs = {0.005922}},
    {.inputs = {0.833670, -0.612780, 0.191200, 0.915160, 0.745170, 0.022130, 0.572740, 0.728570},       .outputs = {0.011651}},
    {.inputs = {0.981750, 0.629810, -0.244970, -0.705010, -0.444320, 0.248210, 0.398420, 0.310280},     .outputs = {0.047309}},
    {.inputs = {-0.585680, 0.335800, -0.007420, -0.585620, 0.006260, 0.556020, 0.238620, -0.727590},    .outputs = {0.052585}},
    {.inputs = {-0.255170, 0.513290, 0.668810, 0.611930, -0.822690, 0.424600, 0.468490, 0.131570},      .outputs = {0.089573}},
    {.inputs = {-0.153660, 0.639390, -0.328650, 0.442920, -0.775750, 0.497360, 0.110870, -0.880670},    .outputs = {0.090832}},
    {.inputs = {-0.168310, -0.703480, -0.427720, 0.987060, 0.258100, 0.175820, -0.599050, -0.722530},   .outputs = {0.116900}},
};

static double get_error(micro_network_t *net, dataset_entry_t *dataset, size_t dataset_size, uint32_t num_outputs) {
    // Works only with single output networks
    double error = 0;
    for(size_t i=0; i<dataset_size; i++) {
        double *outputs = micronet_get_output(net, dataset[i].inputs);
        double e = 0.0;
        for(uint32_t j=0; j<num_outputs; j++) {
            double delta = dataset[i].outputs[j] - outputs[j];
            e += delta * delta;
        }

        printf("Desired outputs: [");
        for(uint32_t j=0; j<num_outputs-1; j++) {
            printf("%f, ", dataset[i].outputs[j]);
        }
        printf("%f], ", dataset[i].outputs[num_outputs-1]);

        printf("real outputs: [");
        for(uint32_t j=0; j<num_outputs-1; j++) {
            printf("%f, ", outputs[j]);
        }
        printf("%f];\n", outputs[num_outputs-1]);

        error += e;
    }
    return error / dataset_size;
}

static void train_net(micro_network_t *target_net, micro_network_t *c_net, micro_network_t *f_net, dataset_entry_t *dataset, size_t dataset_size, uint32_t num_outputs) {
    // Works only with single output networks
    // double error = 0;
    double *errors = calloc(num_outputs, sizeof(double));
    for(size_t i=0; i<dataset_size; i++) {
        double *outputs = micronet_get_output(target_net, dataset[i].inputs);
        double e = 0.0;
        for(uint32_t j=0; j<num_outputs; j++) {
            double delta = dataset[i].outputs[j] - outputs[j];
            errors[j] = delta * delta;
            e += errors[j];
        }
        micronet_set_global_error(target_net, e/num_outputs, errors);

        
        // double new_error = get_error(&target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
        // double delta = new_error - init_error;
        // double e_val = delta * delta;
        // // #error "Update f_micronet (5 inputs and 2 outputs)"
        micronet_update_feedbacks(target_net, f_net);
        micronet_update_coeffs(target_net, c_net);

        // printf("Desired outputs: [");
        // for(uint32_t j=0; j<num_outputs-1; j++) {
        //     printf("%f, ", dataset[i].outputs[j]);
        // }
        // printf("%f], ", dataset[i].outputs[num_outputs-1]);

        // printf("real outputs: [");
        // for(uint32_t j=0; j<num_outputs-1; j++) {
        //     printf("%f, ", outputs[j]);
        // }
        // printf("%f];\n", outputs[num_outputs-1]);

        // error += e;
    }
}

/*
feedback:
    n_params->coeffs,
    n_params->inputs,
    n_params->output,
    feedback_val,
    feedbacks[own_index].stash,
coeff:
    n_params->coeffs,
    n_params->inputs,
    n_params->output,
    feedback_val,
    n_params->c_net_stash,
num_inputs: 3+8+256 = 267
*/

uint32_t f_neurons[] = {
    // idx  num_inputs  type indices
     267,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     268,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     269,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     270,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     271,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     272,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     273,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     274,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,

     275,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     276,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     277,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     278,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     279,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     280,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     281,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     282,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,

     283,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     284,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     285,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     286,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     287,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     288,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     289,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     290,   16,          0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,

     291,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 0 feedback
     292,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 1 feedback
     293,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 2 feedback
     294,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 3 feedback
     295,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 4 feedback
     296,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 5 feedback
     297,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 6 feedback
     298,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Input 7 feedback

     299,   8,          1,   283, 284, 285, 286, 287, 288, 289, 290,    // Feedback stash
};

micronet_map_t f_micronet_map = {
    .num_inputs = 267,
    .num_neurons = 33,
    .net_size = 300,
    .neurons = f_neurons,
    .num_outputs = 9,
    .output_indices = {291, 292, 293, 294, 295, 296, 297, 298, 299},
};

uint32_t c_neurons[] = {
    // idx  num_inputs  type indices
     267,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     268,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     269,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     270,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     271,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     272,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     273,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     274,   256,        0,   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266,

     275,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     276,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     277,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     278,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     279,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     280,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     281,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,
     282,   11,         0,   257, 258, 259, 260, 261, 262, 263, 264, 265, 266,

     283,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     284,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     285,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     286,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     287,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     288,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     289,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,
     290,   16,         0,   267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,

     291,   8,          1,   0, 264, 265, 266,        285, 287, 290, 289,
     292,   8,          1,   1, 264, 265, 266,        286, 287, 283, 290,
     293,   8,          1,   2, 264, 265, 266,        285, 290, 286, 288,
     294,   8,          1,   3, 264, 265, 266,        290, 289, 286, 283,
     295,   8,          1,   4, 264, 265, 266,        283, 289, 287, 284,
     296,   8,          1,   5, 264, 265, 266,        287, 288, 285, 289,
     297,   8,          1,   6, 264, 265, 266,        289, 283, 290, 287,
     298,   8,          1,   7, 264, 265, 266,        287, 290, 288, 285,
     299,   8,          1,   8, 264, 265, 266,        290, 287, 285, 283,
     300,   8,          1,   9, 264, 265, 266,        289, 286, 285, 283,
     301,   8,          1,   10, 264, 265, 266,       285, 288, 290, 287,
     302,   8,          1,   11, 264, 265, 266,       288, 289, 286, 290,
     303,   8,          1,   12, 264, 265, 266,       284, 283, 287, 288,
     304,   8,          1,   13, 264, 265, 266,       289, 285, 288, 287,
     305,   8,          1,   14, 264, 265, 266,       289, 286, 290, 285,
     306,   8,          1,   15, 264, 265, 266,       289, 285, 283, 288,
     307,   8,          1,   16, 264, 265, 266,       283, 285, 289, 286,
     308,   8,          1,   17, 264, 265, 266,       289, 283, 290, 285,
     309,   8,          1,   18, 264, 265, 266,       289, 290, 283, 288,
     310,   8,          1,   19, 264, 265, 266,       286, 284, 287, 288,
     311,   8,          1,   20, 264, 265, 266,       287, 286, 289, 288,
     312,   8,          1,   21, 264, 265, 266,       286, 290, 289, 283,
     313,   8,          1,   22, 264, 265, 266,       285, 286, 284, 288,
     314,   8,          1,   23, 264, 265, 266,       289, 290, 283, 286,
     315,   8,          1,   24, 264, 265, 266,       287, 288, 289, 286,
     316,   8,          1,   25, 264, 265, 266,       285, 284, 283, 286,
     317,   8,          1,   26, 264, 265, 266,       286, 287, 285, 284,
     318,   8,          1,   27, 264, 265, 266,       287, 284, 289, 288,
     319,   8,          1,   28, 264, 265, 266,       288, 284, 286, 287,
     320,   8,          1,   29, 264, 265, 266,       283, 284, 285, 289,
     321,   8,          1,   30, 264, 265, 266,       284, 287, 289, 285,
     322,   8,          1,   31, 264, 265, 266,       288, 283, 286, 290,
     323,   8,          1,   32, 264, 265, 266,       283, 285, 287, 284,
     324,   8,          1,   33, 264, 265, 266,       289, 287, 283, 284,
     325,   8,          1,   34, 264, 265, 266,       290, 286, 285, 289,
     326,   8,          1,   35, 264, 265, 266,       289, 287, 285, 288,
     327,   8,          1,   36, 264, 265, 266,       286, 285, 283, 289,
     328,   8,          1,   37, 264, 265, 266,       283, 286, 289, 284,
     329,   8,          1,   38, 264, 265, 266,       289, 287, 285, 286,
     330,   8,          1,   39, 264, 265, 266,       285, 287, 284, 289,
     331,   8,          1,   40, 264, 265, 266,       285, 283, 286, 284,
     332,   8,          1,   41, 264, 265, 266,       284, 290, 288, 283,
     333,   8,          1,   42, 264, 265, 266,       289, 288, 286, 283,
     334,   8,          1,   43, 264, 265, 266,       289, 284, 286, 283,
     335,   8,          1,   44, 264, 265, 266,       283, 290, 284, 287,
     336,   8,          1,   45, 264, 265, 266,       283, 286, 284, 288,
     337,   8,          1,   46, 264, 265, 266,       290, 288, 287, 285,
     338,   8,          1,   47, 264, 265, 266,       283, 290, 288, 287,
     339,   8,          1,   48, 264, 265, 266,       290, 283, 286, 288,
     340,   8,          1,   49, 264, 265, 266,       284, 283, 290, 287,
     341,   8,          1,   50, 264, 265, 266,       284, 283, 287, 288,
     342,   8,          1,   51, 264, 265, 266,       284, 287, 285, 288,
     343,   8,          1,   52, 264, 265, 266,       288, 285, 284, 287,
     344,   8,          1,   53, 264, 265, 266,       289, 285, 284, 286,
     345,   8,          1,   54, 264, 265, 266,       288, 290, 283, 287,
     346,   8,          1,   55, 264, 265, 266,       289, 284, 285, 287,
     347,   8,          1,   56, 264, 265, 266,       290, 287, 283, 284,
     348,   8,          1,   57, 264, 265, 266,       290, 283, 288, 286,
     349,   8,          1,   58, 264, 265, 266,       289, 286, 284, 283,
     350,   8,          1,   59, 264, 265, 266,       290, 287, 289, 288,
     351,   8,          1,   60, 264, 265, 266,       290, 287, 284, 289,
     352,   8,          1,   61, 264, 265, 266,       284, 289, 283, 286,
     353,   8,          1,   62, 264, 265, 266,       288, 285, 289, 284,
     354,   8,          1,   63, 264, 265, 266,       285, 289, 284, 290,
     355,   8,          1,   64, 264, 265, 266,       284, 287, 285, 288,
     356,   8,          1,   65, 264, 265, 266,       283, 288, 286, 290,
     357,   8,          1,   66, 264, 265, 266,       289, 288, 283, 284,
     358,   8,          1,   67, 264, 265, 266,       290, 288, 289, 286,
     359,   8,          1,   68, 264, 265, 266,       283, 289, 286, 290,
     360,   8,          1,   69, 264, 265, 266,       286, 285, 290, 287,
     361,   8,          1,   70, 264, 265, 266,       284, 290, 288, 287,
     362,   8,          1,   71, 264, 265, 266,       288, 285, 286, 284,
     363,   8,          1,   72, 264, 265, 266,       289, 288, 290, 285,
     364,   8,          1,   73, 264, 265, 266,       286, 287, 283, 284,
     365,   8,          1,   74, 264, 265, 266,       288, 289, 287, 286,
     366,   8,          1,   75, 264, 265, 266,       288, 283, 290, 284,
     367,   8,          1,   76, 264, 265, 266,       288, 290, 283, 289,
     368,   8,          1,   77, 264, 265, 266,       283, 284, 288, 286,
     369,   8,          1,   78, 264, 265, 266,       283, 287, 289, 284,
     370,   8,          1,   79, 264, 265, 266,       290, 286, 287, 283,
     371,   8,          1,   80, 264, 265, 266,       285, 290, 288, 284,
     372,   8,          1,   81, 264, 265, 266,       287, 283, 290, 284,
     373,   8,          1,   82, 264, 265, 266,       289, 285, 283, 284,
     374,   8,          1,   83, 264, 265, 266,       285, 288, 283, 284,
     375,   8,          1,   84, 264, 265, 266,       286, 283, 288, 290,
     376,   8,          1,   85, 264, 265, 266,       287, 290, 284, 289,
     377,   8,          1,   86, 264, 265, 266,       288, 285, 287, 289,
     378,   8,          1,   87, 264, 265, 266,       288, 287, 284, 285,
     379,   8,          1,   88, 264, 265, 266,       284, 286, 289, 288,
     380,   8,          1,   89, 264, 265, 266,       283, 285, 284, 286,
     381,   8,          1,   90, 264, 265, 266,       287, 290, 289, 288,
     382,   8,          1,   91, 264, 265, 266,       288, 289, 285, 284,
     383,   8,          1,   92, 264, 265, 266,       288, 283, 290, 284,
     384,   8,          1,   93, 264, 265, 266,       288, 289, 290, 286,
     385,   8,          1,   94, 264, 265, 266,       285, 284, 290, 286,
     386,   8,          1,   95, 264, 265, 266,       285, 288, 290, 289,
     387,   8,          1,   96, 264, 265, 266,       287, 289, 285, 290,
     388,   8,          1,   97, 264, 265, 266,       284, 286, 289, 283,
     389,   8,          1,   98, 264, 265, 266,       289, 283, 290, 288,
     390,   8,          1,   99, 264, 265, 266,       288, 290, 284, 285,
     391,   8,          1,   100, 264, 265, 266,      286, 289, 290, 288,
     392,   8,          1,   101, 264, 265, 266,      285, 290, 284, 283,
     393,   8,          1,   102, 264, 265, 266,      283, 290, 286, 288,
     394,   8,          1,   103, 264, 265, 266,      285, 287, 289, 286,
     395,   8,          1,   104, 264, 265, 266,      290, 283, 288, 287,
     396,   8,          1,   105, 264, 265, 266,      290, 288, 286, 283,
     397,   8,          1,   106, 264, 265, 266,      289, 285, 286, 284,
     398,   8,          1,   107, 264, 265, 266,      285, 286, 288, 283,
     399,   8,          1,   108, 264, 265, 266,      289, 283, 287, 285,
     400,   8,          1,   109, 264, 265, 266,      284, 290, 288, 283,
     401,   8,          1,   110, 264, 265, 266,      283, 287, 286, 284,
     402,   8,          1,   111, 264, 265, 266,      283, 284, 289, 287,
     403,   8,          1,   112, 264, 265, 266,      284, 289, 286, 290,
     404,   8,          1,   113, 264, 265, 266,      284, 285, 287, 288,
     405,   8,          1,   114, 264, 265, 266,      285, 289, 283, 288,
     406,   8,          1,   115, 264, 265, 266,      286, 283, 287, 285,
     407,   8,          1,   116, 264, 265, 266,      286, 288, 283, 284,
     408,   8,          1,   117, 264, 265, 266,      286, 283, 287, 285,
     409,   8,          1,   118, 264, 265, 266,      289, 286, 284, 285,
     410,   8,          1,   119, 264, 265, 266,      287, 289, 284, 288,
     411,   8,          1,   120, 264, 265, 266,      285, 289, 290, 287,
     412,   8,          1,   121, 264, 265, 266,      285, 290, 283, 289,
     413,   8,          1,   122, 264, 265, 266,      283, 285, 289, 284,
     414,   8,          1,   123, 264, 265, 266,      290, 289, 287, 283,
     415,   8,          1,   124, 264, 265, 266,      283, 290, 288, 284,
     416,   8,          1,   125, 264, 265, 266,      283, 287, 284, 288,
     417,   8,          1,   126, 264, 265, 266,      290, 286, 284, 288,
     418,   8,          1,   127, 264, 265, 266,      285, 286, 290, 288,
     419,   8,          1,   128, 264, 265, 266,      289, 283, 290, 284,
     420,   8,          1,   129, 264, 265, 266,      290, 288, 286, 284,
     421,   8,          1,   130, 264, 265, 266,      283, 284, 286, 290,
     422,   8,          1,   131, 264, 265, 266,      284, 283, 289, 286,
     423,   8,          1,   132, 264, 265, 266,      285, 289, 286, 290,
     424,   8,          1,   133, 264, 265, 266,      289, 284, 285, 287,
     425,   8,          1,   134, 264, 265, 266,      290, 288, 289, 287,
     426,   8,          1,   135, 264, 265, 266,      288, 283, 285, 284,
     427,   8,          1,   136, 264, 265, 266,      286, 290, 283, 284,
     428,   8,          1,   137, 264, 265, 266,      283, 286, 287, 288,
     429,   8,          1,   138, 264, 265, 266,      286, 285, 284, 290,
     430,   8,          1,   139, 264, 265, 266,      287, 289, 284, 286,
     431,   8,          1,   140, 264, 265, 266,      288, 284, 290, 287,
     432,   8,          1,   141, 264, 265, 266,      290, 288, 289, 283,
     433,   8,          1,   142, 264, 265, 266,      290, 288, 289, 287,
     434,   8,          1,   143, 264, 265, 266,      286, 283, 284, 290,
     435,   8,          1,   144, 264, 265, 266,      285, 288, 289, 286,
     436,   8,          1,   145, 264, 265, 266,      290, 289, 287, 286,
     437,   8,          1,   146, 264, 265, 266,      286, 287, 283, 288,
     438,   8,          1,   147, 264, 265, 266,      284, 286, 285, 287,
     439,   8,          1,   148, 264, 265, 266,      286, 284, 287, 285,
     440,   8,          1,   149, 264, 265, 266,      289, 288, 284, 283,
     441,   8,          1,   150, 264, 265, 266,      290, 285, 283, 288,
     442,   8,          1,   151, 264, 265, 266,      284, 290, 287, 283,
     443,   8,          1,   152, 264, 265, 266,      289, 287, 284, 283,
     444,   8,          1,   153, 264, 265, 266,      286, 290, 285, 287,
     445,   8,          1,   154, 264, 265, 266,      285, 287, 284, 283,
     446,   8,          1,   155, 264, 265, 266,      290, 288, 283, 284,
     447,   8,          1,   156, 264, 265, 266,      287, 285, 290, 288,
     448,   8,          1,   157, 264, 265, 266,      288, 284, 283, 290,
     449,   8,          1,   158, 264, 265, 266,      287, 288, 290, 289,
     450,   8,          1,   159, 264, 265, 266,      284, 286, 289, 285,
     451,   8,          1,   160, 264, 265, 266,      286, 289, 284, 285,
     452,   8,          1,   161, 264, 265, 266,      287, 286, 290, 288,
     453,   8,          1,   162, 264, 265, 266,      290, 287, 289, 284,
     454,   8,          1,   163, 264, 265, 266,      288, 285, 287, 283,
     455,   8,          1,   164, 264, 265, 266,      285, 284, 290, 286,
     456,   8,          1,   165, 264, 265, 266,      285, 289, 290, 286,
     457,   8,          1,   166, 264, 265, 266,      290, 284, 287, 286,
     458,   8,          1,   167, 264, 265, 266,      290, 287, 284, 288,
     459,   8,          1,   168, 264, 265, 266,      287, 289, 284, 290,
     460,   8,          1,   169, 264, 265, 266,      288, 284, 290, 286,
     461,   8,          1,   170, 264, 265, 266,      287, 288, 290, 284,
     462,   8,          1,   171, 264, 265, 266,      288, 283, 285, 290,
     463,   8,          1,   172, 264, 265, 266,      283, 286, 285, 289,
     464,   8,          1,   173, 264, 265, 266,      287, 289, 288, 284,
     465,   8,          1,   174, 264, 265, 266,      285, 287, 283, 286,
     466,   8,          1,   175, 264, 265, 266,      289, 286, 285, 288,
     467,   8,          1,   176, 264, 265, 266,      290, 284, 286, 287,
     468,   8,          1,   177, 264, 265, 266,      287, 290, 283, 284,
     469,   8,          1,   178, 264, 265, 266,      287, 283, 284, 289,
     470,   8,          1,   179, 264, 265, 266,      289, 285, 288, 287,
     471,   8,          1,   180, 264, 265, 266,      289, 288, 284, 290,
     472,   8,          1,   181, 264, 265, 266,      290, 285, 286, 287,
     473,   8,          1,   182, 264, 265, 266,      284, 283, 286, 290,
     474,   8,          1,   183, 264, 265, 266,      283, 285, 286, 287,
     475,   8,          1,   184, 264, 265, 266,      284, 283, 285, 287,
     476,   8,          1,   185, 264, 265, 266,      289, 287, 288, 285,
     477,   8,          1,   186, 264, 265, 266,      289, 284, 286, 287,
     478,   8,          1,   187, 264, 265, 266,      289, 285, 286, 287,
     479,   8,          1,   188, 264, 265, 266,      286, 284, 289, 285,
     480,   8,          1,   189, 264, 265, 266,      286, 289, 283, 287,
     481,   8,          1,   190, 264, 265, 266,      283, 284, 288, 287,
     482,   8,          1,   191, 264, 265, 266,      290, 285, 286, 289,
     483,   8,          1,   192, 264, 265, 266,      290, 283, 286, 284,
     484,   8,          1,   193, 264, 265, 266,      287, 286, 290, 289,
     485,   8,          1,   194, 264, 265, 266,      285, 289, 284, 290,
     486,   8,          1,   195, 264, 265, 266,      288, 286, 284, 287,
     487,   8,          1,   196, 264, 265, 266,      288, 289, 290, 283,
     488,   8,          1,   197, 264, 265, 266,      283, 290, 288, 284,
     489,   8,          1,   198, 264, 265, 266,      285, 283, 289, 287,
     490,   8,          1,   199, 264, 265, 266,      288, 283, 289, 285,
     491,   8,          1,   200, 264, 265, 266,      288, 284, 289, 287,
     492,   8,          1,   201, 264, 265, 266,      288, 290, 284, 286,
     493,   8,          1,   202, 264, 265, 266,      289, 284, 286, 288,
     494,   8,          1,   203, 264, 265, 266,      284, 290, 287, 288,
     495,   8,          1,   204, 264, 265, 266,      283, 286, 287, 285,
     496,   8,          1,   205, 264, 265, 266,      290, 283, 286, 288,
     497,   8,          1,   206, 264, 265, 266,      290, 285, 287, 284,
     498,   8,          1,   207, 264, 265, 266,      284, 290, 285, 286,
     499,   8,          1,   208, 264, 265, 266,      284, 289, 290, 288,
     500,   8,          1,   209, 264, 265, 266,      286, 288, 283, 289,
     501,   8,          1,   210, 264, 265, 266,      286, 289, 284, 287,
     502,   8,          1,   211, 264, 265, 266,      287, 283, 289, 286,
     503,   8,          1,   212, 264, 265, 266,      285, 283, 289, 290,
     504,   8,          1,   213, 264, 265, 266,      286, 289, 283, 288,
     505,   8,          1,   214, 264, 265, 266,      284, 289, 283, 287,
     506,   8,          1,   215, 264, 265, 266,      287, 286, 290, 283,
     507,   8,          1,   216, 264, 265, 266,      289, 283, 290, 286,
     508,   8,          1,   217, 264, 265, 266,      288, 289, 285, 290,
     509,   8,          1,   218, 264, 265, 266,      284, 289, 288, 290,
     510,   8,          1,   219, 264, 265, 266,      285, 290, 284, 289,
     511,   8,          1,   220, 264, 265, 266,      283, 285, 286, 290,
     512,   8,          1,   221, 264, 265, 266,      283, 284, 289, 288,
     513,   8,          1,   222, 264, 265, 266,      286, 285, 289, 287,
     514,   8,          1,   223, 264, 265, 266,      288, 289, 286, 284,
     515,   8,          1,   224, 264, 265, 266,      283, 290, 287, 285,
     516,   8,          1,   225, 264, 265, 266,      285, 286, 287, 288,
     517,   8,          1,   226, 264, 265, 266,      289, 287, 288, 285,
     518,   8,          1,   227, 264, 265, 266,      284, 283, 286, 287,
     519,   8,          1,   228, 264, 265, 266,      286, 288, 284, 290,
     520,   8,          1,   229, 264, 265, 266,      288, 290, 289, 285,
     521,   8,          1,   230, 264, 265, 266,      286, 289, 283, 285,
     522,   8,          1,   231, 264, 265, 266,      290, 288, 286, 285,
     523,   8,          1,   232, 264, 265, 266,      285, 290, 283, 287,
     524,   8,          1,   233, 264, 265, 266,      287, 285, 290, 286,
     525,   8,          1,   234, 264, 265, 266,      283, 289, 284, 288,
     526,   8,          1,   235, 264, 265, 266,      287, 285, 289, 283,
     527,   8,          1,   236, 264, 265, 266,      290, 288, 284, 286,
     528,   8,          1,   237, 264, 265, 266,      287, 288, 285, 284,
     529,   8,          1,   238, 264, 265, 266,      283, 289, 284, 285,
     530,   8,          1,   239, 264, 265, 266,      288, 289, 290, 287,
     531,   8,          1,   240, 264, 265, 266,      289, 288, 283, 286,
     532,   8,          1,   241, 264, 265, 266,      289, 288, 290, 285,
     533,   8,          1,   242, 264, 265, 266,      287, 289, 285, 286,
     534,   8,          1,   243, 264, 265, 266,      289, 283, 284, 288,
     535,   8,          1,   244, 264, 265, 266,      285, 288, 289, 286,
     536,   8,          1,   245, 264, 265, 266,      283, 287, 285, 286,
     537,   8,          1,   246, 264, 265, 266,      289, 286, 285, 290,
     538,   8,          1,   247, 264, 265, 266,      287, 285, 284, 290,
     539,   8,          1,   248, 264, 265, 266,      290, 286, 283, 284,
     540,   8,          1,   249, 264, 265, 266,      286, 290, 283, 285,
     541,   8,          1,   250, 264, 265, 266,      288, 290, 289, 284,
     542,   8,          1,   251, 264, 265, 266,      290, 289, 285, 288,
     543,   8,          1,   252, 264, 265, 266,      283, 284, 285, 290,
     544,   8,          1,   253, 264, 265, 266,      284, 285, 287, 289,
     545,   8,          1,   254, 264, 265, 266,      289, 287, 284, 283,
     546,   8,          1,   255, 264, 265, 266,      289, 288, 286, 290,
};

micronet_map_t c_micronet_map = {
    .num_inputs = 5,
    .num_neurons = 7,
    .net_size = 12,
    .neurons = c_neurons,
    .num_outputs = 2,
    .output_indices = {10, 11},
};

void init_coeffs(micro_network_t *net) {
    for(uint32_t i=0; i<9; i++) {
        for(uint32_t j=0; j<256; j++) {
            neuron_set_coeff(&net->neurons[i], j, poly_coeffs[i][j]);
        }
    }
}

// static double get_delta(micro_network_t *target_net, micro_network_t *c_net, micro_network_t *f_net) {
//     double init_error = get_error(target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
//     micronet_clear_feedbacks(target_net);
//     train_net(target_net, c_net, f_net, linear_dataset, sizeof_arr(linear_dataset), 1);

//     double final_error = get_error(target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
//     if(init_error == 0.0) {
//         return 0;
//     }
//     double delta;
//     if(init_error > final_error) {
//         delta = (init_error - final_error) / init_error;
//     } else {
//         delta = -1 * (final_error - init_error) / final_error;
//     }
//     // printf("init_error: %f, final_error: %f, delta: %f\n", init_error, final_error, delta);
//     return delta;
// }

// static double get_average_delta(micro_network_t *target_net, micro_network_t *c_net, micro_network_t *f_net, double coeff_inc) {
//     double init_average_delta = 0.0;
//     uint32_t average_delta_counter = 0;

//     for(uint32_t n=0; n<5; n++) {
//         for(uint32_t c=0; c<5; c++) {
//             init_coeffs(target_net);
//             neuron_set_coeff(&target_net->neurons[n], c, coeff_inc);

//             init_average_delta += get_delta(target_net, c_net, f_net);
//             average_delta_counter++;
//         }
//     }

//     return init_average_delta / average_delta_counter;
// }

int main(void) {
    srand(time(NULL));
    micro_network_t target_net = {0};
    micronet_init(&target_net, &poly_micronet_map);
    init_coeffs(&target_net);
    micronet_print_coeffs(&target_net);
    printf("Target microNet initialised!\n");
    micro_network_t c_micronet = {0};
    micronet_init(&c_micronet, &smart_micronet_map);
    printf("C microNet initialised!\n");
    micro_network_t f_micronet = {0};
    micronet_init(&f_micronet, &smart_micronet_map);
    printf("F microNet initialised!\n");

    char *c_net_path = BCKP_DIR_PATH "/poly/c_unet";
    char *f_net_path = BCKP_DIR_PATH "/poly/f_unet";
    // micronet_restore(&c_micronet, c_net_path);
    // micronet_restore(&f_micronet, f_net_path);

    // // Dataset generator
    // for(uint32_t i=0; i<16; i++) {
    //     double inputs[8] = {
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //         random_double(-1, 1),
    //     };
    //     double *outputs = micronet_get_output(&target_net, inputs);
    //     printf("{.inputs = {%f, %f, %f, %f, %f, %f, %f, %f}, .outputs = {%f}},\n",
    //                                                                     inputs[0],
    //                                                                     inputs[1],
    //                                                                     inputs[2],
    //                                                                     inputs[3],
    //                                                                     inputs[4],
    //                                                                     inputs[5],
    //                                                                     inputs[6],
    //                                                                     inputs[7],
    //                                                                     outputs[0]);
    // }
    // return 0;

    double init_error = get_error(&target_net, poly_dataset, sizeof_arr(poly_dataset), 1);
    printf("Init error: %f\n", init_error);
    return 0;

    // char *n_path = concat_strings(BCKP_DIR_PATH, "/target_unet");
    // micronet_save(&target_net, n_path);
    
    // for(uint32_t i=0; i<5; i++) {
    //     for(uint32_t j=0; j<5; j++) {
    //         neuron_set_coeff(&target_net.neurons[i], j, 0.1);
    //     }
    // }
    // init_error = get_error(&target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
    // printf("Error after save: %f\n", init_error);
    // micronet_restore(&target_net, n_path);
    // init_error = get_error(&target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
    // printf("Error after restore: %f\n", init_error);
    // return 0;

    // double delta_sum = 0;
    // uint32_t delta_counter = 0;
    // uint32_t pos_delta_counter = 0;
    // uint32_t pos_new_delta_counter = 0;
    // uint32_t delta_improved_counter = 0;

    // for(uint32_t i=0; i<10000; i++) {
    //     // printf("Round %d:\n", i);

    //     // uint32_t coords[2] = {
    //     //     random_int(0, 5),
    //     //     random_int(0, 5)
    //     // };
    //     double coeff_inc = random_double(-0.5, 0.5);

    //     double init_average_delta = get_average_delta(&target_net, &c_micronet, &f_micronet, coeff_inc);

    //     delta_sum += init_average_delta;
    //     delta_counter ++;
    //     if(init_average_delta > 0) {
    //         pos_delta_counter ++;
    //     }

    //     micronet_mutate(&c_micronet);
    //     micronet_mutate(&f_micronet);

    //     double after_average_delta = get_average_delta(&target_net, &c_micronet, &f_micronet, coeff_inc);

    //     if(after_average_delta < init_average_delta) {
    //         micronet_rollback(&f_micronet);
    //         micronet_rollback(&c_micronet);
    //     }
    //     if(after_average_delta > init_average_delta) {
    //         delta_improved_counter ++;
    //     }
    //     if(i%1000 == 0) {
    //         printf("Init delta: %f, new_delta: %f, average delta: %f\n", init_average_delta, after_average_delta, delta_sum/delta_counter);
    //         fflush(stdout);
    //         if(i > 0) {
    //             micronet_save(&c_micronet, c_net_path);
    //             micronet_save(&f_micronet, f_net_path);
    //         }
    //     }
    //     if(after_average_delta > 0) {
    //         pos_new_delta_counter ++;
    //     }
    // }
    // // double current_error = get_error(&target_net, linear_dataset, sizeof_arr(linear_dataset), 1);
    // // printf("Current error: %f\n", current_error);
    // printf("Average_delta: %f, delta_counter = %d\n", delta_sum/delta_counter, delta_counter);
    // printf("Positive delta counter: %d\n", pos_delta_counter);
    // printf("Positive new delta counter: %d\n", pos_new_delta_counter);
    // printf("Improved delta counter: %d\n", delta_improved_counter);
    // printf("c_micronet coeffs:\n");
    // micronet_print_coeffs(&c_micronet);
    // printf("f_micronet coeffs:\n");
    // micronet_print_coeffs(&f_micronet);

    // // remove_folders(BCKP_DIR_PATH);
    // micronet_save(&c_micronet, c_net_path);
    // micronet_save(&f_micronet, f_net_path);
    return EXIT_SUCCESS;
}